(defpackage :grupo02pareja022ZG1804 ; se declara un paquete lisp que usa common-lisp
(:use :common-lisp :mancala) ; y mancala, y exporta la función de evaluación
(:export :heuristica :*alias*)) ; heurística y un alias para el torneo

(in-package grupo02pareja022ZG1804)

(defvar *alias* '|Gazorpazorfield 987-6|) ; alias que aparecerá en el ranking

(defun prod-escalar (v1 v2)
  (apply #'+ (mapcar #'* v1 v2)))

(defun matriz-x-vector (m v)
  (mapcar #'(lambda (fila) (prod-escalar fila v)) m))

(defun suma-vectores (v1 v2)
  (mapcar #'+ v1 v2))

(defun inputs (estado)
  (let ((tablero (estado-tablero estado))
        (mi-lado (estado-lado-sgte-jugador estado)))
      (append (input-lado tablero mi-lado 0)
            (input-lado tablero (lado-contrario mi-lado) 0))))

(defun input-lado (tablero lado pos)
  (unless (equal pos 7)
    (cons (get-fichas tablero lado pos)
          (input-lado tablero lado (+ 1 pos)))))

(defun heuristica (estado)
(+ 0.5220613845691597
(prod-escalar '(-0.7919080031301917 -0.06009520076857999 0.7173418626221928 0.6084864777279388 0.6430907418010929 -0.1659346954076153 0.3946710509678111 -0.16166798439957386 0.5352551968905543 -0.9358791105853637)
(suma-vectores '(0.7859561428303619 -0.15339427062228972 -0.28552544148080705 0.09818920042178036 0.9596484577187345 0.5343568509227246 -0.3356596837301713 0.2011812978148746 0.5091893192737016 0.3263992974926757)
(matriz-x-vector '((0.03833681807264 0.6454437236275983 0.2231886375480865 0.9377371327080277 0.9193845551046014 0.6324648540315614 -0.010186627975292017 0.2740282041636064 -0.04174675953836382 0.19046290240879316 -0.9919103639640421 -0.8897997122898618 -0.23702015613988592 0.6543087500918741)
 (0.0830253029830943 -0.17780350938089895 -0.41876295763656035 -0.7353394252499921 -0.6382291736195735 0.8505896330370952 -0.5228991171517281 -0.7449476869502663 -0.5670421249523221 -0.06043776695905523 -0.6579259907951642 -0.9474006901575764 0.8947465229742202 0.8616203262771365)
 (0.5335299295309137 -0.09975277430167107 -0.4332684867338321 0.40523428884705104 0.0667873481106167 -0.42062539571671187 0.8907692437465766 -0.2658711094673034 0.6537228708639207 -0.6086318548457126 -0.27093103178784816 0.6743086728298708 -0.6995486615409041 -0.3902420625716083)
 (-0.6123808462233891 0.4309375411659999 0.5569270875415726 0.0671610372945568 0.7280220682108587 -0.0014302262873067129 -0.7135537553740579 -0.6556893290898969 -0.5975298233647788 0.9359778877190301 0.05048358178675327 -0.8078397255032954 0.19432802626286771 -0.21444008427818972)
 (-0.46834939800220887 -0.22665480842630958 -0.22972154321945215 -0.3640305265848094 -0.14259987433955246 -0.29396609976768184 -0.2851936524227052 0.9964479665902011 -0.8174748306437205 0.5033096176862504 -0.07464066410975323 -0.5991476235598581 0.17417738043689912 -0.3311547897621081)
 (0.6502706511340945 -0.14521256032339647 0.2722713770426328 0.6638258296308506 0.30549793991065366 -0.4988342098556231 -0.7722652440861177 -0.09235028508065013 0.6967441609504972 0.8358177162366758 -0.30802208446444834 -0.2030860980509308 -0.8164387092506877 0.4350334837606453)
 (0.5643692499919106 -0.1547732809085478 -0.669204966076014 -0.4396221552809083 0.23114705399575897 -0.6597806088757463 0.42237520329935707 0.2787747618094216 0.8725795729354331 0.9326698919037804 -0.1171012662428701 -0.9264983353724003 -0.36710793570566436 0.005858769551110088)
 (0.17836234537718765 0.013428487746797835 -0.4026695617511564 -0.05138453075743055 -0.9211683139547087 -0.1827139824357913 0.7961094624369007 -0.828378900084368 -0.8952648975808666 -0.6116446707949152 -0.655050084526952 -0.7728367678796342 -0.7149775563871814 -0.4508373466973725)
 (0.14319481293766634 0.21870236630900397 -0.12560691247545774 0.8129839707076376 0.8940241664219424 0.22542239266151842 0.5856050409378226 -0.7027746170146583 0.7782545708259536 0.16176892568668033 0.8765233010598699 -0.9625438813765514 0.2690123173084995 -0.5709965306026414)
 (0.47947336794331297 -0.8064493739075402 -0.7373605740828142 0.19244572413050198 0.8644684888890708 0.6131587207472537 -0.9762574014031109 -0.39019560356939853 -0.9067734419339142 -0.879656238178341 -0.7568416135539169 0.30059651471254556 -0.6009681579842696 -0.18614614514835526)
)
(inputs estado))))))


