(defpackage :grupo02pareja023ZG1904 ; se declara un paquete lisp que usa common-lisp
(:use :common-lisp :mancala) ; y mancala, y exporta la función de evaluación
(:export :heuristica :*alias*)) ; heurística y un alias para el torneo

(in-package grupo02pareja023ZG1904)

(defvar *alias* '|Gazorpazorfield 499-7|) ; alias que aparecerá en el ranking

(defun prod-escalar (v1 v2)
  (apply #'+ (mapcar #'* v1 v2)))

(defun matriz-x-vector (m v)
  (mapcar #'(lambda (fila) (prod-escalar fila v)) m))

(defun suma-vectores (v1 v2)
  (mapcar #'+ v1 v2))

(defun inputs (estado)
  (let ((tablero (estado-tablero estado))
        (mi-lado (estado-lado-sgte-jugador estado)))
      (append (input-lado tablero mi-lado 0)
            (input-lado tablero (lado-contrario mi-lado) 0))))

(defun input-lado (tablero lado pos)
  (unless (equal pos 7)
    (cons (get-fichas tablero lado pos)
          (input-lado tablero lado (+ 1 pos)))))

(defun heuristica (estado)
(+ 0.6551167208053044
(prod-escalar '(-0.9443524018520884 -0.8527941741767471 -0.22785623170013047 0.450323586320438 0.23696746985574135 -0.9429673301437576 0.260998259425991 0.5989415299715306 0.8639451483188196 0.18446907122401912)
(suma-vectores '(0.009773082850159431 -0.6925699103751297 -0.5285628547181245 -0.7393887203188538 0.782457105023652 -0.9185162105646214 0.00343081874636586 -0.220934846514101 -0.8374258891401669 -0.9101249390035622)
(matriz-x-vector '((-0.1128784210495497 -0.07255492420778276 -0.030326512138445505 -0.9524589332001663 0.8375462017291224 0.8342453247003636 -0.7841764599770982 0.5791987442919679 0.24246138174574217 -0.9812547893038306 -0.8553245652344255 -0.3039266235707905 -0.018840603409991274 0.5881262368982265)
 (0.20491342852081584 -0.6840241239140834 0.04057177332445461 0.006833699346926458 0.19945963351279405 0.29043188068411374 -0.014924370555845279 -0.35036600062307177 -0.06014330312652638 -0.4408383047783304 0.2811284141357402 -0.7899944981659561 -0.47879164339987224 0.25688219470586726)
 (-0.8913031697226643 0.04405133430964048 -0.7597800513800423 -0.36948983525521695 0.8211101636823106 0.9647723898899083 -0.8514615847406277 -0.24838865835261892 0.13459533497518228 0.03940026353527304 0.9565961108512147 -0.9643476147731898 -0.011777417371684473 0.869025768491497)
 (0.02878028735552185 0.5208177929662174 0.12021359365958406 -0.8118706313841484 -0.21142485077225892 -0.8186213406306149 0.17300091492350478 -0.6945769116724472 0.3660639523162439 -0.8886291762693921 -0.16534616550543557 -0.35834520867131947 -0.3155492357829295 -0.152810856175968)
 (0.5905748092670351 -0.31435277104609605 0.25425424772069416 -0.17625560983050947 0.9576991249769975 0.2221433704731286 0.6318495837656875 0.7042541520146253 -0.023034103234878867 0.6611227400957045 -0.9371127180949679 0.32377516879801593 0.8776843111152539 -0.7050822259894733)
 (0.043341475668292606 0.7296223303639908 -0.038384694227176386 0.7061822975117453 0.9753865207067474 0.9168349641535307 -0.6887087129713647 -0.7156580414125087 -0.682346593303204 -0.44633192172864233 -0.9401975248082266 0.619345599630609 0.7953527174584096 0.6360269289928442)
 (-0.30039197482988045 0.9175853106321208 -0.31945193882680356 0.5063718664646719 -0.4564526056989644 0.7141897585576173 0.7641792849494373 -0.20659950983155673 0.3937137476312802 -0.91980145065872 -0.1783816117470043 0.9823196993697223 -0.6119150969876714 0.0703301534215266)
 (-0.23790348948740103 -0.8452927775125709 -0.6072643515388854 0.12054803592542451 0.7240516463123796 -0.16372889367873555 -0.1538476448263324 -0.07658738124975217 0.4586763008769854 -0.5238882620249907 -0.03814140953886769 -0.7993112363782002 -0.15926916553888737 0.7132130359062661)
 (-0.4495595593028865 0.7161224535053479 -0.16998764655369203 -0.5576808455514892 0.7335908942930123 0.4038365586855688 0.9381501095306215 0.8059634227525443 -0.6168775703904215 -0.6712591775690901 0.6149634167458691 -0.6588982959639607 0.210581556836281 -0.5338636587110008)
 (0.09299549204003843 0.3477235169986761 0.6446799249103821 -0.8271737412867843 0.9777825918846663 0.5609689364953621 0.19607377633843148 0.5287454790797379 -0.8905548894929107 0.15245669362425973 -0.2997160477299772 0.9896967679582598 0.6405601719085925 -0.6825980487750991)
)
(inputs estado))))))
