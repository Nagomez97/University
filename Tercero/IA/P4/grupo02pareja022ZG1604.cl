(defpackage :grupo02pareja022ZG1604 ; se declara un paquete lisp que usa common-lisp
(:use :common-lisp :mancala) ; y mancala, y exporta la función de evaluación
(:export :heuristica :*alias*)) ; heurística y un alias para el torneo

(in-package grupo02pareja022ZG1604)

(defvar *alias* '|ultraGazor|) ; alias que aparecerá en el ranking

(defun prod-escalar (v1 v2)
  (apply #'+ (mapcar #'* v1 v2)))

(defun matriz-x-vector (m v)
  (mapcar #'(lambda (fila) (prod-escalar fila v)) m))

(defun suma-vectores (v1 v2)
  (mapcar #'+ v1 v2))

(defun inputs (estado)
  (let ((tablero (estado-tablero estado))
        (mi-lado (estado-lado-sgte-jugador estado)))
      (append (input-lado tablero mi-lado 0)
            (input-lado tablero (lado-contrario mi-lado) 0))))

(defun input-lado (tablero lado pos)
  (unless (equal pos 7)
    (cons (get-fichas tablero lado pos)
          (input-lado tablero lado (+ 1 pos)))))

(defun heuristica (estado)
(+ 0.19908300502846088
(prod-escalar '(-0.4340477558974365 0.267326544083929 0.3510867767598802 -0.27146626396369755 -0.675766116566431 -0.6205293822173812 0.671004950299984 0.6934055421847258 -0.9915061405745387 0.84703755056952)
(suma-vectores '(-0.9477449762230115 -0.07588281758862547 0.03935751216449668 -0.5956687365456503 -0.32638220071504653 0.22978855359506545 0.0004916980879463573 -0.21718788963861524 0.368634288511416 0.8201573218355449)
(matriz-x-vector '((-0.6569718836193792 -0.5500797203605903 0.734320139438337 0.388550297634668 0.9301346641148527 0.13499647547151272 -0.5009442092758847 0.9355910501568778 0.1683979894413541 -0.6972096841260464 -0.0036654745052442372 0.4050563838822323 -0.8435386847003172 0.5536554692739348)
 (0.39426236918364177 -0.9601084247076428 0.6622039088496057 0.25208066532617757 -0.5164482040207603 -0.480486722156908 0.30152339274689566 -0.11958340218722752 -0.8406293199685588 0.749105645433783 0.6369264469103681 -0.6395483638734687 -0.6953884485245103 -0.44619709538033336)
 (-0.5005367640806409 0.5418161155153272 0.7113657944668967 -0.6111251666779505 0.9670667354092686 0.14331625228160405 0.24465709738689623 0.49599966936584905 0.5849505187463182 0.4724630848016922 -0.4580179208654711 -0.5779176704194877 -0.5488922258810689 -0.6582034249593738)
 (0.1321764066671567 -0.11807608353557253 -0.9216216950764429 -0.29479288019162686 0.11250094317472326 -0.6662766561553761 -0.4439648990005267 0.9740446091998867 0.22085718454449377 0.3095711968135191 0.7461402191923887 0.014620553568955641 -0.17730425022811636 -0.0970802824049466)
 (-0.6642820322977621 -0.7483658105460664 0.3885987182772519 -0.3541150932614119 0.7579607644523818 0.8282036748106072 0.21860194282203138 0.07334406413497896 -0.07658971809609016 -0.6821170617789163 -0.9487262825618339 -0.3870598937712457 -0.35269414260164167 -0.35136578130171325)
 (0.37892802767097056 -0.8484491721811411 0.7710153484291573 0.7376680675590319 0.7826913704092586 0.7924229823099431 -0.12458113249358549 -0.19286590909294787 0.07893803872556626 0.3321728674844642 -0.13806538067856922 0.16692555785122765 -0.13351886700727866 -0.589932625777517)
 (0.4488795246070858 -0.9068953097939916 -0.03071985492775675 -0.043909737305304786 0.6830409472157579 -0.6862554820774402 0.221048516709351 0.9559873769180949 -0.07801904745248 0.7014292770506794 0.05759892222450902 -0.11507796499646084 0.7246624538707143 -0.817062370867099)
 (0.46570106676302947 -0.06972711176943958 0.9785421085355566 -0.0529780276836167 -0.8287129254436658 -0.9043854625650125 0.9198893767924867 -0.5342706664872656 -0.18783349706174213 -0.5086335406014628 -0.4625431094633936 -0.5519309122549938 -0.6564395026255527 -0.5200948762303195)
 (0.47602578074961666 -0.9701866031252928 0.2136031859067935 0.5478379463934668 0.049738387015273444 -0.318369054299096 0.1933122249632595 -0.34265676840529036 -0.7416384524539514 -0.29219641596405177 -0.22994907406219922 0.1337113845214697 -0.5064290641127613 0.8026685310875059)
 (0.15162563963042408 -0.3367747951037048 0.41987256818322716 0.5433015000055736 0.7560064702186045 0.3899913852507575 0.9135517459988345 0.05957130400151045 -0.1026147020790813 0.508313407973213 0.9850461755562647 -0.18493825149465626 -0.763234693135163 0.9719587273699459)
)
(inputs estado))))))


