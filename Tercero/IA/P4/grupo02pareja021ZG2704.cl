(defpackage :grupo02pareja021ZG2704 ; se declara un paquete lisp que usa common-lisp
(:use :common-lisp :mancala) ; y mancala, y exporta la función de evaluación
(:export :heuristica :*alias*)) ; heurística y un alias para el torneo

(in-package grupo02pareja021ZG2704)

(defvar *alias* '|Gazorpazorpfield 7-37|) ; alias que aparecerá en el ranking

(defun prod-escalar (v1 v2)
  (apply #'+ (mapcar #'* v1 v2)))

(defun matriz-x-vector (m v)
  (mapcar #'(lambda (fila) (prod-escalar fila v)) m))

(defun suma-vectores (v1 v2)
  (mapcar #'+ v1 v2))

(defun inputs (estado)
  (let ((tablero (estado-tablero estado))
        (mi-lado (estado-lado-sgte-jugador estado)))
      (append (input-lado tablero mi-lado 0)
            (input-lado tablero (lado-contrario mi-lado) 0))))

(defun input-lado (tablero lado pos)
  (unless (equal pos 7)
    (cons (get-fichas tablero lado pos)
          (input-lado tablero lado (+ 1 pos)))))

(defun heuristica (estado)
(+ -0.2991526166032432
(prod-escalar '(-0.40498928687333446 0.13548952849423967 -0.8205614718289422 0.44575266422154725 0.724253296114439 -0.24471091908784004 -0.39072067365259744 -0.7354875756128427 0.22268448134732655 0.13027535252790878)
(suma-vectores '(-0.3445662928417532 0.12453900058211365 0.18415676977357465 0.5726499004495742 -0.2645364855809371 -0.3549906817384443 -0.9848222332927465 -0.3305150011731448 -0.36377269489068387 -0.10057077207493714)
(matriz-x-vector '((0.4646206980997454 0.3975618199096569 -0.6645829740948024 -0.7505173624958603 0.04210867041904698 0.9990847963942802 0.5352607156266851 0.8670944431012026 -0.23958204116492232 0.6788439406514373 -0.7132858803554838 -0.4835956092747653 -0.9102159916583563 0.6096235454314725)
 (-0.4164331650814854 -0.05288911716676381 0.6055016077976518 -0.7590123089888894 -0.9612600100190758 0.9828945321002616 0.31421819487063574 0.10967044894917821 -0.16179686745019528 0.06191226881410117 -0.06213014733818789 -0.6955686662286875 -0.7877845467927358 -0.8267089862182564)
 (-0.5467100371585776 0.39339052106304484 -0.29117020763013013 0.967632039694085 0.29071738317472695 0.6363752152698934 -0.987778809316185 -0.5396139115415441 -0.6442982625616114 -0.6163531233308073 -0.28240958933829075 0.01818193031806481 0.5754311400654759 -0.5658682662022956)
 (-0.8690201258582992 0.8563808640014619 0.23686772234520648 0.23062528501690704 0.8272300867488904 -0.09297670230322552 -0.08285185657700578 -0.828284834504833 0.7599555865294336 0.1196623490267783 0.8074610656842702 0.7531036290611397 0.5414967705803657 -0.8176769830982105)
 (-0.07303814972509026 0.7090172085862818 0.4703377808867242 0.867439491440948 0.07601102590432607 -0.271355429160554 -0.7557506439970347 0.21828156486254535 -0.12527887036411167 0.7183527283565974 0.5542806097801016 0.09098967615373588 -0.44994112783282403 0.33962883502831787)
 (-0.49831837147359437 -0.8422797296666202 0.058354875218116886 -0.8967480839510649 -0.533238942070339 -0.35698613948383495 0.38223629290317285 -0.018198877563843974 -0.5771901010037903 0.5412769149755934 -0.4939388305446166 0.7633773003850091 0.24072472315383675 0.591120231874434)
 (0.8077477568427052 0.9668493727118133 0.48899976128192857 -0.09299680694955414 0.7454398657132568 0.5353541332911194 -0.7598683396887227 -0.2689939859612569 -0.3497063085702279 0.8855158183134781 0.5594270905518199 0.04892107540723334 0.486645328256575 0.42690976206848474)
 (-0.14179334217498396 -0.2159256779892922 0.8388131723834324 0.7307990573021583 0.6213843121886793 0.09766732821918866 -0.8090533886430233 0.1260972584622131 -0.5748893057417379 0.45294533976472007 -0.19836406929685424 0.41855480738925777 -0.4046395630827686 0.8829411252949249)
 (-0.3415744948170061 0.5571434685832655 0.054374554068333136 -0.4163536428029222 0.538862240287056 0.9580767259668208 0.8778513995728314 -0.18655699865536612 -0.26653115335424316 -0.18604810308610964 0.2735679138132905 -0.5377665937709815 -0.4306666980724001 -0.7223773743454809)
 (0.10327660922364967 -0.6423022524765598 -0.3304492685817737 -0.20284989133380749 -0.5752292443348246 0.6899870742138043 -0.9693162398394541 -0.3024600724413462 0.344766887945567 0.9140202500627228 0.1567572866672704 -0.6702136876865203 0.3790932401612461 -0.36030268778399055)
)
(inputs estado))))))


