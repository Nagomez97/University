(defpackage :grupo02pareja023ZG2604 ; se declara un paquete lisp que usa common-lisp
(:use :common-lisp :mancala) ; y mancala, y exporta la función de evaluación
(:export :heuristica :*alias*)) ; heurística y un alias para el torneo

(in-package grupo02pareja023ZG2604)

(defvar *alias* '|Gazorpazorpfield 112-12|) ; alias que aparecerá en el ranking

(defun prod-escalar (v1 v2)
  (apply #'+ (mapcar #'* v1 v2)))

(defun matriz-x-vector (m v)
  (mapcar #'(lambda (fila) (prod-escalar fila v)) m))

(defun suma-vectores (v1 v2)
  (mapcar #'+ v1 v2))

(defun inputs (estado)
  (let ((tablero (estado-tablero estado))
        (mi-lado (estado-lado-sgte-jugador estado)))
      (append (input-lado tablero mi-lado 0)
            (input-lado tablero (lado-contrario mi-lado) 0))))

(defun input-lado (tablero lado pos)
  (unless (equal pos 7)
    (cons (get-fichas tablero lado pos)
          (input-lado tablero lado (+ 1 pos)))))

(defun heuristica (estado)
(+ -0.5520118938473741
(prod-escalar '(0.30403463463597213 -0.7144267588129536 0.6164916142984471 -0.369330604084102 -0.5171527678495369 0.9242095108805679 0.8267070271107102 0.05312022828904084 0.3794957982848486 0.0795434185383348)
(suma-vectores '(0.8494512883212502 0.013562923468220411 -0.5475048978007806 0.9249537072713498 -0.7141034196318936 -0.44643861901475845 0.7329432259354494 -0.9409549343817816 -0.0875054605139094 0.9179729656154592)
(matriz-x-vector '((0.03559836296962815 -0.10110251655471347 -0.7118987764648943 0.027070001726238857 0.8823369876432339 -0.5215808742986368 0.3322167408960992 0.6184458796504688 0.8419281295513388 -0.3371701051726206 0.9951204176322803 -0.7218387323240998 0.24101539349867718 -0.3431220002124842)
 (0.07443995941018522 -0.16562400872466387 0.41324216490312726 -0.19088776100188554 -0.7139657805025281 0.6875414642608182 -0.28358205142106674 -0.34908840299018906 -0.7262857177055118 0.801807389520002 0.13531037065097684 0.6086368688563684 -0.2259547520199876 -0.2188388412775195)
 (0.4618438942959713 0.20332215547739807 0.7716567215185883 -0.24209332200684264 -0.44948254839018764 -0.6218034637444525 0.8586867424272571 -0.3317164039706959 0.7617349304210137 -0.6806279625744411 0.749701607847417 -0.08197513199698925 -0.6000562172768498 -0.4505958371841021)
 (0.4504270473683252 -0.2426867475100265 0.05230363604686361 -0.6430894728082526 0.3745363385248264 -0.3915461171306731 -0.48484553942469977 -0.7076707542172926 -0.9620541134892975 -0.07856223269468332 0.1284752975616903 -0.5404377039949881 -0.19182694543201517 -0.6186509851974913)
 (0.9886099233938843 -0.4493703897443555 -0.014826567458008588 -0.8412360849153182 0.7058121400332034 -0.19505088814317073 -0.6397524113654773 -0.6172452802894774 0.06264088583766925 -0.6275186055211792 -0.1634129177731274 -0.7285123565007603 0.31377990498461705 0.14657281207985928)
 (0.1273706842272806 0.3809800051659291 0.40436764452343965 -0.9432662554431512 0.8016946577032686 0.9635934645100361 0.9173732903085619 0.6646217349225236 0.6212728706175858 0.14428689917684046 -0.4018917215485853 -0.2143119177336814 -0.8714932318859772 -0.0852606061211496)
 (0.4487891173284333 0.18871585660443846 0.7459656351012749 0.8775400081335349 -0.6959525037830874 -0.5271101461129002 0.913424844506165 0.3952601390845818 0.803173698288463 0.20881923919649759 -0.9661337803992389 0.21078149819630876 -0.5621374513213973 -0.05970514443264485)
 (0.4364968779811311 0.11489717978545966 0.6572662940774159 -0.5412461587466155 0.503523654060789 -0.6126615230559902 0.246260969507057 -0.28136901029948436 -0.20985571205748732 0.5466945392812983 0.07000438808184284 -0.9127470417386796 -0.35246557837108217 0.9832636172992077)
 (-0.709686994856944 0.09059003664397736 -0.0901807109414432 -0.725521863097262 -0.22980442798390643 -0.38591937791484066 -0.05208600505548522 0.28552088937157993 -0.9068291945583469 0.8467991994349442 0.5473766889634599 -0.07229656586237443 -0.740954818032586 -0.8355494109943944)
 (-0.3147038835141944 -0.7717772507356533 0.37286881139404104 0.1019441496823974 0.6583181968947251 -0.28129553747902203 -0.5795102962802559 -0.13380553889353264 -0.35009085780812166 0.7698794494842611 -0.6279566687215099 -0.8353207996283805 0.04961496818144795 -0.7022857889039797)
)
(inputs estado))))))


